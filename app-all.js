/*
Copyright(c) 2012 Company Name
*/
Ext.define("Ext.picker.Slot",{extend:"Ext.DataView",xtype:"pickerslot",alternateClassName:"Ext.Picker.Slot",requires:["Ext.XTemplate","Ext.data.Store","Ext.Component","Ext.data.StoreManager"],isSlot:true,config:{title:null,showTitle:true,cls:Ext.baseCSSPrefix+"picker-slot",name:null,value:null,flex:1,align:"left",displayField:"text",valueField:"value",scrollable:{direction:"vertical",indicators:false,momentumEasing:{minVelocity:2},slotSnapEasing:{duration:100}}},constructor:function(){this.selectedIndex=0;this.callParent(arguments)},applyTitle:function(a){if(a){a=Ext.create("Ext.Component",{cls:Ext.baseCSSPrefix+"picker-slot-title",docked:"top",html:a})}return a},updateTitle:function(b,a){if(b){this.add(b);this.setupBar()}if(a){this.remove(a)}},updateShowTitle:function(a){var b=this.getTitle();if(b){b[a?"show":"hide"]();this.setupBar()}},updateDisplayField:function(a){this.setItemTpl('<div class="'+Ext.baseCSSPrefix+'picker-item {cls} <tpl if="extra">'+Ext.baseCSSPrefix+'picker-invalid</tpl>">{'+a+"}</div>")},updateAlign:function(a,c){var b=this.element;b.addCls(Ext.baseCSSPrefix+"picker-"+a);b.removeCls(Ext.baseCSSPrefix+"picker-"+c)},applyData:function(d){var f=[],c=d&&d.length,a,b,e;if(d&&Ext.isArray(d)&&c){for(a=0;a<c;a++){b=d[a];e={};if(Ext.isArray(b)){e[this.valueField]=b[0];e[this.displayField]=b[1]}else{if(Ext.isString(b)){e[this.valueField]=b;e[this.displayField]=b}else{if(Ext.isObject(b)){e=b}}}f.push(e)}}return d},updateData:function(a){this.setStore(Ext.create("Ext.data.Store",{model:"x-textvalue",data:a}))},initialize:function(){this.callParent();var a=this.getScrollable().getScroller();this.on({scope:this,painted:"onPainted",itemtap:"doItemTap"});a.on({scope:this,scrollend:"onScrollEnd"})},onPainted:function(){this.setupBar()},getPicker:function(){if(!this.picker){this.picker=this.getParent()}return this.picker},setupBar:function(){if(!this.rendered){return}var b=this.element,g=this.innerElement,h=this.getPicker(),i=h.bar,m=this.getValue(),c=this.getShowTitle(),l=this.getTitle(),j=this.getScrollable(),f=j.getScroller(),e=0,o,d,n,k,a;o=i.getY();d=b.getY();if(c&&l){d+=l.element.getHeight()}n=i.getHeight();if(c&&l){e=l.element.getHeight()}k=Math.ceil((b.getHeight()-e-n)/2);this.slotPadding=k;g.setStyle({padding:k+"px 0 "+(k)+"px"});f.refresh();f.setSlotSnapSize(n);this.setValue(m)},doItemTap:function(d,a,c,f){var b=this;b.selectedIndex=a;b.selectedNode=c;b.scrollToItem(c,true);b.fireEvent("slotpick",b,b.getValue(),b.selectedNode)},scrollToItem:function(e,d){var h=e.getY(),c=e.parent(),f=c.getY(),b=this.getScrollable(),a=b.getScroller(),g;g=h-f;a.scrollTo(0,g,d)},onScrollEnd:function(b,a,g){var f=this,d=Math.round(g/f.picker.bar.getHeight()),c=f.getViewItems(),e=c[d];if(e){f.selectedIndex=d;f.selectedNode=e;f.fireEvent("slotpick",f,f.getValue(),f.selectedNode)}},getValue:function(){var b=this.getStore(),a,c;if(!b){return}if(!this.rendered){return this._value}if(this._value===false){return null}a=b.getAt(this.selectedIndex);c=a?a.get(this.getValueField()):null;this._value=c;return c},setValue:function(f){if(!Ext.isDefined(f)){return}if(!this.rendered||!f){this._value=f;return}var b=this.getStore(),a=this.getViewItems(),d=this.getValueField(),c,e;c=b.find(d,f);if(c!=-1){e=Ext.get(a[c]);this.selectedIndex=c;this.scrollToItem(e);this._value=f}},setValueAnimated:function(f){if(!f){return}if(!this.rendered){this._value=f;return}var b=this.getStore(),a=this.getViewItems(),d=this.getValueField(),c,e;c=b.find(d,f);if(c!=-1){e=Ext.get(a[c]);this.selectedIndex=c;this.scrollToItem(e,{duration:100});this._value=f}}});Ext.define("Ext.picker.Picker",{extend:"Ext.Sheet",alias:"widget.picker",alternateClassName:"Ext.Picker",requires:["Ext.picker.Slot","Ext.Toolbar","Ext.data.Model"],isPicker:true,config:{cls:Ext.baseCSSPrefix+"picker",doneButton:true,cancelButton:true,useTitles:false,slots:null,value:null,height:220,layout:{type:"hbox",align:"stretch"},centered:false,left:0,right:0,bottom:0,defaultType:"pickerslot",toolbar:true},initElement:function(){this.callParent(arguments);var b=this,a=Ext.baseCSSPrefix,c=this.innerElement;this.mask=c.createChild({cls:a+"picker-mask"});this.bar=this.mask.createChild({cls:a+"picker-bar"});b.on({scope:this,delegate:"pickerslot",slotpick:"onSlotPick"});b.on({scope:this,show:"onShow"})},applyToolbar:function(a){if(a===true){a={}}Ext.applyIf(a,{docked:"top"});return Ext.factory(a,"Ext.TitleBar",this.getToolbar())},updateToolbar:function(a,b){if(a){this.add(a)}if(b){this.remove(b)}},applyDoneButton:function(a){if(a){if(Ext.isBoolean(a)){a={}}if(typeof a=="string"){a={text:a}}Ext.applyIf(a,{ui:"action",align:"right",text:"Done"})}return Ext.factory(a,"Ext.Button",this.getDoneButton())},updateDoneButton:function(c,a){var b=this.getToolbar();if(c){b.add(c);c.on("tap",this.onDoneButtonTap,this)}else{if(a){b.remove(a)}}},applyCancelButton:function(a){if(a){if(Ext.isBoolean(a)){a={}}if(typeof a=="string"){a={text:a}}Ext.applyIf(a,{align:"left",text:"Cancel"})}return Ext.factory(a,"Ext.Button",this.getCancelButton())},updateCancelButton:function(b,a){var c=this.getToolbar();if(b){c.add(b);b.on("tap",this.onCancelButtonTap,this)}else{if(a){c.remove(a)}}},updateUseTitles:function(d){var f=this.getInnerItems(),e=f.length,a=Ext.baseCSSPrefix+"use-titles",c,b;if(d){this.addCls(a)}else{this.removeCls(a)}for(c=0;c<e;c++){b=f[c];if(b.isSlot){b.setShowTitle(d)}}},applySlots:function(b){if(b){var c=b.length,a;for(a=0;a<c;a++){b[a].picker=this}}return b},updateSlots:function(a){var b=Ext.baseCSSPrefix,c;this.removeAll();if(a){this.add(a)}c=this.getInnerItems();if(c.length>0){c[0].addCls(b+"first");c[c.length-1].addCls(b+"last")}this.updateUseTitles(this.getUseTitles())},onDoneButtonTap:function(){var a=this._value,b=this.getValue();if(b!=a){this.fireEvent("change",this,b)}this.hide()},onCancelButtonTap:function(){this.fireEvent("cancel",this);this.hide()},onSlotPick:function(c,b,a){this.fireEvent("pick",this,this.getValue(),c)},onShow:function(){if(!this.isHidden()){this.setValue(this._value)}},setValue:function(j,a){var f=this,d=f.getInnerItems(),e=d.length,h,g,c,b;if(!j){j={};for(b=0;b<e;b++){j[d[b].config.name]=false}}for(h in j){value=j[h];for(b=0;b<d.length;b++){c=d[b];if(c.config.name==h){g=c;break}}if(g){if(a){g.setValueAnimated(value)}else{g.setValue(value)}}}f._value=this.getValue();f._values=f._value;return f},setValueAnimated:function(a){this.setValue(a,true)},getValue:function(){var b={},a=this.getItems().items,e=a.length,d,c;for(c=0;c<e;c++){d=a[c];if(d&&d.isSlot){b[d.getName()]=d.getValue()}}this._values=b;return this._values},getValues:function(){return this.getValue()},destroy:function(){this.callParent();Ext.destroy(this.mask,this.bar)}},function(){Ext.deprecateProperty(this,"activeCls",null,"Ext.picker.Picker.activeCls has been removed");Ext.deprecateClassMethod(this,"getCard","getActiveItem");Ext.deprecateClassMethod(this,"setCard","setActiveItem");Ext.define("x-textvalue",{extend:"Ext.data.Model",config:{fields:["text","value"]}})});Ext.define("Ext.field.Select",{extend:"Ext.field.Text",xtype:"selectfield",alternateClassName:"Ext.form.Select",requires:["Ext.Panel","Ext.picker.Picker","Ext.data.Store","Ext.data.StoreManager","Ext.List"],config:{ui:"select",valueField:"value",displayField:"text",store:null,options:null,hiddenName:null,component:{useMask:true},clearIcon:false,usePicker:"auto",defaultPhonePickerConfig:null,defaultTabletPickerConfig:null,name:"picker"},constructor:function(a){a=a||{};if(!a.store){a.store=true}this.callParent([a])},initialize:function(){var b=this,a=b.getComponent();b.callParent();a.on({scope:b,masktap:"onMaskTap"});a.input.dom.disabled=true},updateDefaultPhonePickerConfig:function(b){var a=this.picker;if(a){a.setConfig(b)}},updateDefaultTabletPickerConfig:function(a){var b=this.listPanel;if(b){b.setConfig(a)}},applyUsePicker:function(a){if(a=="auto"){a=(Ext.os.deviceType=="Phone")}return Boolean(a)},syncEmptyCls:Ext.emptyFn,applyValue:function(c){var a=c,b;this.getOptions();if(!(c instanceof Ext.data.Model)){b=this.getStore().find(this.getValueField(),c,null,null,null,true);if(b==-1){b=this.getStore().find(this.getDisplayField(),c,null,null,null,true)}a=this.getStore().getAt(b)}return a},updateValue:function(b,a){this.previousRecord=a;this.record=b;this.callParent([b?b.get(this.getDisplayField()):""]);if(a!==b&&this.initialized){this.fireEvent("change",this,b,a)}},getValue:function(){var a=this.record;return(a)?a.get(this.getValueField()):null},getRecord:function(){return this.record},getPhonePicker:function(){var a=this.getDefaultPhonePickerConfig();if(!this.picker){this.picker=Ext.create("Ext.picker.Picker",Ext.apply({slots:[{align:"center",name:this.getName(),valueField:this.getValueField(),displayField:this.getDisplayField(),value:this.getValue(),store:this.getStore()}],listeners:{change:this.onPickerChange,scope:this}},a))}return this.picker},getTabletPicker:function(){var a=this.getDefaultTabletPickerConfig();if(!this.listPanel){this.listPanel=Ext.create("Ext.Panel",Ext.apply({centered:true,modal:true,cls:Ext.baseCSSPrefix+"select-overlay",layout:"fit",hideOnMaskTap:true,items:{xtype:"list",store:this.getStore(),itemTpl:'<span class="x-list-label">{'+this.getDisplayField()+"}</span>",listeners:{select:this.onListSelect,itemtap:this.onListTap,scope:this}}},a))}return this.listPanel},onMaskTap:function(){if(this.getDisabled()){return false}this.showPicker();return false},showPicker:function(){if(this.getStore().getCount()===0){return}if(this.getReadOnly()){return}this.isFocused=true;if(this.getUsePicker()){var e=this.getPhonePicker(),d=this.getName(),h={};h[d]=this.record.get(this.getValueField());e.setValue(h);if(!e.getParent()){Ext.Viewport.add(e)}e.show()}else{var f=this.getTabletPicker(),g=f.down("list"),b=g.getStore(),c=b.find(this.getValueField(),this.getValue(),null,null,null,true),a=b.getAt((c==-1)?0:c);if(!f.getParent()){Ext.Viewport.add(f)}f.showBy(this.getComponent());g.select(a,null,true)}},onListSelect:function(c,a){var b=this;if(a){b.setValue(a)}},onListTap:function(){this.listPanel.hide({type:"fade",out:true,scope:this})},onPickerChange:function(d,f){var e=this,g=f[e.getName()],b=e.getStore(),c=b.find(e.getValueField(),g,null,null,null,true),a=b.getAt(c);e.setValue(a)},updateOptions:function(b){var a=this.getStore();if(!b){a.clearData()}else{a.setData(b);this.onStoreDataChanged(a)}},applyStore:function(a){if(a===true){a=Ext.create("Ext.data.Store",{fields:[this.getValueField(),this.getDisplayField()]})}if(a){a=Ext.data.StoreManager.lookup(a);a.on({scope:this,addrecords:this.onStoreDataChanged,removerecords:this.onStoreDataChanged,updaterecord:this.onStoreDataChanged,refresh:this.onStoreDataChanged})}return a},updateStore:function(a){if(a){this.onStoreDataChanged(a)}},onStoreDataChanged:function(a){var c=this.getInitialConfig(),b=this.getValue();if(Ext.isDefined(b)){this.updateValue(this.applyValue(b))}if(this.getValue()===null){if(c.hasOwnProperty("value")){this.setValue(c.value)}if(this.getValue()===null){if(a.getCount()>0){this.setValue(a.getAt(0))}}}},doSetDisabled:function(a){Ext.Component.prototype.doSetDisabled.apply(this,arguments)},setDisabled:function(){Ext.Component.prototype.setDisabled.apply(this,arguments)},reset:function(){var b=this.getStore(),a=(this.originalValue)?this.originalValue:b.getAt(0);if(b&&a){this.setValue(a)}return this},onFocus:function(a){this.fireEvent("focus",this,a);this.isFocused=true;this.showPicker()},destroy:function(){this.callParent(arguments);Ext.destroy(this.listPanel,this.picker,this.hiddenField)}});Ext.require("Ext.data.Store");Ext.require("Ext.dataview.List");Ext.require("Ext.field.Checkbox");Ext.require("Ext.Img");var SayloCoords;Ext.application({name:"SayloMobile",requires:["Ext.MessageBox","SayloMobile.config"],controllers:["Login"],viewport:{autoMaximize:true},coords:{},foo:"bar",setCoords:function(a){SayloMobile.app.coords=a},getCoords:function(){return SayloMobile.app.coords},views:["Login"],icon:{57:"resources/icons/Icon.png",72:"resources/icons/Icon~ipad.png",114:"resources/icons/Icon@2x.png",144:"resources/icons/Icon~ipad@2x.png"},phoneStartupScreen:"resources/loading/Homescreen.jpg",tabletStartupScreen:"resources/loading/Homescreen~ipad.jpg",launch:function(){Ext.fly("appLoadingIndicator").destroy();var a={xtype:"login"};Ext.Viewport.add(a)},onUpdated:function(){Ext.Msg.confirm("Application Update","This application has just successfully been updated to the latest version. Reload now?",function(){window.location.reload()})}});
